{
  "name": "Quirrel",
  "scopeName": "source.quirrel",
  "patterns": [
    { "include": "#all" }
  ],
  "repository": {
    "all": {
      "patterns": [
        { "include": "#comments" },
        { "include": "#import-statement" },
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "global": {
      "patterns": [
        { "include": "#comments" }
      ]
    },

    "block": {
      "begin": "\\{",
      "beginCaptures": { "0": { "name": "punctuation.definition.block.begin.quirrel" } },
      "end": "\\}",
      "endCaptures": { "0": { "name": "punctuation.definition.block.end.quirrel" } },
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "block-contents": {
      "patterns": [
        { "include": "#global" },
        { "include": "#array" },
        { "include": "#constants" },
        { "include": "#strings" },
        { "include": "#method" },
        { "include": "#global-const" },
        { "include": "#global-enum" },
        { "include": "#class" },
        { "include": "#enum" },
        { "include": "#variable" },
        { "include": "#let-binding" },
        { "include": "#modifiers" },
        { "include": "#for-loop" },
        { "include": "#keywords" },
        { "include": "#method-call" },
        { "include": "#lambda-expression" },
        { "include": "#punctuation-braces" },
        { "include": "#operators" },
        { "include": "#operator-assignment" },
        { "include": "#punctuation-terminator" },
        { "include": "#punctuation-comma" },
        { "include": "#punctuation-accessor" },
        { "include": "#identifiers" }
      ]
    },

    "identifiers": {
      "patterns": [
        { "include": "#constant-name" },
        { "include": "#identifier-name" }
      ]
    },

    "import-statement": {
      "patterns": [
        {
          "comment": "from 'module' import name, name2 as alias",
          "begin": "\\b(from)\\b",
          "beginCaptures": { "1": { "name": "keyword.control.import.quirrel" } },
          "end": "(?=;)|(?=$)",
          "patterns": [
            { "include": "#strings" },
            {
              "match": "\\b(import)\\b",
              "name": "keyword.control.import.quirrel"
            },
            {
              "match": "\\b(as)\\b",
              "name": "keyword.control.import.quirrel"
            },
            {
              "match": "\\*",
              "name": "keyword.operator.import.all.quirrel"
            },
            { "include": "#punctuation-comma" },
            { "include": "#identifier-name" }
          ]
        },
        {
          "comment": "import 'module' or import 'module' as alias",
          "begin": "\\b(import)\\b",
          "beginCaptures": { "1": { "name": "keyword.control.import.quirrel" } },
          "end": "(?=;)|(?=$)",
          "patterns": [
            { "include": "#strings" },
            {
              "match": "\\b(as)\\b",
              "name": "keyword.control.import.quirrel"
            },
            { "include": "#identifier-name" }
          ]
        }
      ]
    },

    "class": {
      "begin": "(?=\\bclass\\b)",
      "end": "(?<=\\})|(;)",
      "endCaptures": { "1": { "name": "punctuation.terminator.quirrel" } },
      "name": "meta.class.quirrel",
      "patterns": [
        { "include": "#class-name" },
        { "include": "#class-name-post" },
        { "include": "#class-block" }
      ]
    },

    "class-name": {
      "begin": "\\b(class)\\b",
      "beginCaptures": { "1": { "name": "storage.type.class.quirrel" } },
      "end": "([_A-Za-z][\\w\\.]*)",
      "endCaptures": { "1": { "name": "entity.name.type.class.quirrel" } },
      "name": "meta.class.identifier.quirrel",
      "patterns": [
        { "include": "#global" }
      ]
    },

    "class-name-post": {
      "begin": "(?<=\\w)",
      "end": "(\\{)",
      "endCaptures": { "1": { "name": "punctuation.definition.block.begin.quirrel" } },
      "patterns": [
        {
          "match": "\\b([_A-Za-z][\\w\\.]*)\\b",
          "name": "entity.name.type.class.quirrel"
        }
      ]
    },

    "class-block": {
      "begin": "(?<=\\{)",
      "end": "(\\})",
      "endCaptures": { "1": { "name": "punctuation.definition.block.end.quirrel" } },
      "name": "meta.block.quirrel",
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "global-const": {
      "match": "\\b(global)\\s+(const)\\b",
      "captures": {
        "1": { "name": "storage.modifier.quirrel" },
        "2": { "name": "storage.modifier.quirrel" }
      }
    },

    "global-enum": {
      "begin": "\\b(global)\\s+(enum)\\b",
      "beginCaptures": {
        "1": { "name": "storage.modifier.quirrel" },
        "2": { "name": "storage.type.class.quirrel" }
      },
      "end": "(?<=\\})|(;)",
      "endCaptures": { "1": { "name": "punctuation.terminator.quirrel" } },
      "name": "meta.enum.quirrel",
      "patterns": [
        { "include": "#global-enum-name" },
        { "include": "#enum-name-post" },
        { "include": "#enum-block" }
      ]
    },

    "global-enum-name": {
      "begin": "(?<=enum)\\s*",
      "end": "([_A-Za-z][\\w]*)",
      "endCaptures": { "1": { "name": "entity.name.type.class.quirrel" } },
      "patterns": [
        { "include": "#global" }
      ]
    },

    "enum": {
      "begin": "(?=\\benum\\b)",
      "end": "(?<=\\})|(;)",
      "endCaptures": { "1": { "name": "punctuation.terminator.quirrel" } },
      "name": "meta.enum.quirrel",
      "patterns": [
        { "include": "#enum-name" },
        { "include": "#enum-name-post" },
        { "include": "#enum-block" }
      ]
    },

    "enum-name": {
      "begin": "\\b(enum)\\b",
      "beginCaptures": { "1": { "name": "storage.type.class.quirrel" } },
      "end": "([_A-Za-z][\\w]*)",
      "endCaptures": { "1": { "name": "entity.name.type.class.quirrel" } },
      "patterns": [
        { "include": "#global" }
      ]
    },

    "enum-name-post": {
      "begin": "(?<=\\w)",
      "end": "(\\{)",
      "endCaptures": { "1": { "name": "punctuation.definition.block.begin.quirrel" } },
      "patterns": [
        { "include": "#global" }
      ]
    },

    "enum-block": {
      "begin": "(?<=\\{)",
      "end": "(\\})",
      "endCaptures": { "1": { "name": "punctuation.definition.block.end.quirrel" } },
      "name": "meta.block.quirrel",
      "patterns": [
        { "include": "#global" },
        { "include": "#parameters" },
        { "include": "#identifiers" }
      ]
    },

    "function-attributes": {
      "begin": "\\[",
      "beginCaptures": { "0": { "name": "punctuation.definition.attributes.begin.quirrel" } },
      "end": "\\]",
      "endCaptures": { "0": { "name": "punctuation.definition.attributes.end.quirrel" } },
      "patterns": [
        {
          "match": "\\b(pure|nodiscard)\\b",
          "name": "storage.modifier.quirrel"
        },
        { "include": "#punctuation-comma" }
      ]
    },

    "lambda-expression": {
      "begin": "@(?=\\s*[\\[(]|\\s*[_A-Za-z])",
      "beginCaptures": { "0": { "name": "storage.type.function.lambda.quirrel" } },
      "end": "(?=\\s*\\{)|(?=\\s*\\$)|(?<=\\))(?=\\s+[^:])",
      "patterns": [
        { "include": "#function-attributes" },
        { "include": "#parameters" },
        { "include": "#type-annotation" },
        {
          "match": "\\b([_A-Za-z][\\w]*)\\b(?=\\s*\\()",
          "name": "entity.name.function.quirrel"
        }
      ]
    },

    "array": {
      "begin": "\\[",
      "beginCaptures": { "0": { "name": "punctuation.definition.array.begin.quirrel" } },
      "end": "\\]",
      "endCaptures": { "0": { "name": "punctuation.definition.array.end.quirrel" } },
      "name": "meta.array.literal.quirrel",
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "constants": {
      "patterns": [
        {
          "match": "\\btrue\\b",
          "name": "constant.language.boolean.true.quirrel"
        },
        {
          "match": "\\bfalse\\b",
          "name": "constant.language.boolean.false.quirrel"
        },
        {
          "match": "\\bnull\\b",
          "name": "constant.language.null.quirrel"
        },
        {
          "match": "\\b[-]?[0-9][0-9_]*(\\.)[0-9_]+(?:[eE][+-]?[0-9_]+)?\\b",
          "captures": {
            "0": { "name": "constant.numeric.float.quirrel" },
            "1": { "name": "meta.delimiter.decimal.period.quirrel" }
          }
        },
        {
          "match": "\\b[0-9][0-9_]*\\b",
          "name": "constant.numeric.integer.decimal.quirrel"
        },
        {
          "match": "\\b0(x|X)[\\h_]+\\b",
          "name": "constant.numeric.integer.hexadecimal.quirrel"
        },
        {
          "match": "\\b0(x|X)[\\w_]*\\b",
          "name": "invalid.illegal.integer.hexadecimal.quirrel"
        },
        {
          "match": "(\\')(?:[^'\\\\]|(\\\\.|\\\\x[\\h]{2}))(\\')",
          "name": "constant.numeric.integer.other.quirrel",
          "captures": {
            "1": { "name": "punctuation.definition.string.begin.quirrel" },
            "2": {
              "patterns": [
                { "include": "#string-escape-sequences" }
              ]
            },
            "3": { "name": "punctuation.definition.string.end.quirrel" }
          }
        },
        {
          "match": "\\'.{2,}\\'",
          "name": "invalid.illegal.integer.other.quirrel"
        }
      ]
    },

    "comments": {
      "patterns": [
        {
          "begin": "(#).*",
          "beginCaptures": { "1": { "name": "punctuation.definition.comment.quirrel" } },
          "end": "(?=$)",
          "name": "comment.line.number-sign.quirrel"
        },
        {
          "begin": "(\\/\\/).*",
          "beginCaptures": { "1": { "name": "punctuation.definition.comment.quirrel" } },
          "end": "(?=$)",
          "name": "comment.line.double-slash.quirrel"
        },
        {
          "begin": "/\\*(?!/)",
          "beginCaptures": { "1": { "name": "punctuation.definition.comment.quirrel" } },
          "end": "\\*/",
          "endCaptures": { "1": { "name": "punctuation.definition.comment.quirrel" } },
          "name": "comment.block.quirrel"
        }
      ]
    },

    "strings": {
      "patterns": [
        {
          "begin": "@@\\\"",
          "beginCaptures": { "0": { "name": "punctuation.definition.string.begin.quirrel" } },
          "end": "\\\"",
          "endCaptures": { "0": { "name": "punctuation.definition.string.end.quirrel" } },
          "name": "string.quoted.docstring.quirrel",
          "patterns": [
            { "include": "#string-escape-sequences" }
          ]
        },
        {
          "begin": "@\\\"",
          "beginCaptures": { "0": { "name": "punctuation.definition.string.begin.quirrel" } },
          "end": "\\\"",
          "endCaptures": { "0": { "name": "punctuation.definition.string.end.quirrel" } },
          "name": "string.quoted.double.quirrel",
          "patterns": [
            { "include": "#string-escape-sequences" }
          ]
        },
        {
          "begin": "(\\$\\\")",
          "beginCaptures": {
            "0": { "name": "string.quoted.double.quirrel" },
            "1": { "name": "punctuation.definition.string.begin.quirrel" }
          },
          "end": "(\\\")",
          "endCaptures": {
            "0": { "name": "string.quoted.double.quirrel" },
            "1": { "name": "punctuation.definition.string.end.quirrel" }
          },
          "patterns": [
            { "include": "#block" },
            { "include": "#string-escape-sequences" },
            {
              "match" : "[^\\\"\\{\\}]*",
              "name": "string.quoted.double.quirrel"
            }
          ]
        },
        {
          "match": "(\\\")((?:[^\"\\\\]|\\\\.)*)(\\\")",
          "name": "string.quoted.double.quirrel",
          "captures": {
            "1": { "name": "punctuation.definition.string.begin.quirrel" },
            "2": {
              "patterns": [
                { "include": "#string-escape-sequences" }
              ]
            },
            "3": { "name": "punctuation.definition.string.end.quirrel" }
          }
        }
      ]
    },

    "string-escape-sequences": {
      "patterns": [
        {
          "match": "\\\\x[\\h]{2}",
          "name": "constant.character.escape.quirrel"
        },
        {
          "match": "\\\\u[\\h]{4}",
          "name": "constant.character.escape.quirrel"
        },
        {
          "match": "\\\\U[\\h]{8}",
          "name": "constant.character.escape.quirrel"
        },
        {
          "match": "\\\\[0tabnrvf\\\"\\'\\\\]",
          "name": "constant.character.escape.quirrel"
        },
        {
          "match": "\\\\.",
          "name": "invalid.illegal.escape.quirrel"
        }
      ]
    },

    "method": {
      "begin": "(?=\\bfunction\\b)",
      "end": "(?<=[\\}])",
      "name": "meta.method.quirrel",
      "patterns": [
        { "include": "#method-name" },
        { "include": "#method-name-post" },
        { "include": "#method-block" }
      ]
    },

    "method-name": {
      "begin": "\\b(function)\\b",
      "beginCaptures": {
        "1": { "name": "storage.type.function.quirrel" }
      },
      "end": "(?=\\()",
      "patterns": [
        { "include": "#function-attributes" },
        {
          "match": "\\b(constructor)\\b",
          "name": "storage.type.quirrel"
        },
        {
          "match": "\\b([_A-Za-z][\\w]*)\\b",
          "name": "entity.name.function.quirrel"
        }
      ]
    },

    "method-name-post": {
      "begin": "(?<=[\\w\\s])",
      "end": "(\\{)",
      "endCaptures": { "1": { "name": "punctuation.definition.block.begin.quirrel" } },
      "patterns": [
        { "include": "#parameters" },
        { "include": "#type-annotation" },
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "method-block": {
      "begin": "(?<=\\{)",
      "beginCaptures": { "1": { "name": "punctuation.definition.block.begin.quirrel" } },
      "end": "(\\})",
      "endCaptures": { "1": { "name": "punctuation.definition.block.end.quirrel" } },
      "name": "meta.method.block.quirrel",
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "parameters": {
      "begin": "\\(",
      "beginCaptures": { "0": { "name": "punctuation.definition.parameters.begin.quirrel" } },
      "end": "\\s*(\\))",
      "endCaptures": { "1": { "name": "punctuation.definition.parameters.end.quirrel" } },
      "name": "meta.parameters.quirrel",
      "patterns": [
        { "include": "#parameter" }
      ]
    },

    "parameter": {
      "begin": "(?<=\\(|,)",
      "end": "(?=\\)|,)",
      "patterns": [
        { "include": "#parameter-name" },
        { "include": "#type-annotation" },
        { "include": "#parameter-assign" },
        { "include": "#punctuation-comma" },
        { "include": "#global" }
      ]
    },

    "parameter-name": {
      "begin": "(?<=\\(|,)",
      "end": "([_a-zA-Z][\\w]*)",
      "endCaptures": { "1": { "name": "variable.parameter.quirrel" } },
      "patterns": [
        { "include": "#global" },
        { "include": "#operator-optional" }
      ]
    },

    "parameter-assign": {
      "begin": "=",
      "beginCaptures": { "0": { "name": "keyword.operator.assignment.quirrel" } },
      "end": "(?=\\)|,)",
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "operator-optional": {
      "match": "(\\?)(?!\\s)",
      "name": "keyword.operator.optional.quirrel"
    },

    "variable": {
      "begin": "(?=\\blocal\\b)",
      "end": "(?=$)|(;)",
      "endCaptures": { "1": { "name": "punctuation.terminator.quirrel" } },
      "patterns": [
        { "include": "#variable-name" },
        { "include": "#type-annotation" },
        { "include": "#variable-name-next" },
        { "include": "#variable-assign" },
        { "include": "#variable-name-post" }
      ]
    },

    "variable-name": {
      "begin": "\\b(local)\\b",
      "beginCaptures": { "1": { "name": "storage.type.variable.quirrel" } },
      "end": "(?=$)|([_a-zA-Z][\\w]*)",
      "endCaptures": { "1": { "name": "variable.other.quirrel" } },
      "patterns": [
        { "include": "#operator-optional" }
      ]
    },

    "variable-name-next": {
      "begin": ",",
      "beginCaptures": { "0": { "name": "punctuation.separator.comma.quirrel" } },
      "end": "([_a-zA-Z][\\w]*)",
      "endCaptures": { "1": { "name": "variable.other.quirrel" } },
      "patterns": [
        { "include": "#global" }
      ]
    },

    "variable-assign": {
      "begin": "=",
      "beginCaptures": { "0": { "name": "keyword.operator.assignment.quirrel" } },
      "end": "(?=;|,)",
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "variable-name-post": {
      "begin": "(?<=\\w)",
      "end": "(?=;)|(?==)",
      "patterns": [
        { "include": "#block-contents" }
      ]
    },

    "let-binding": {
      "begin": "(?=\\blet\\b)",
      "end": "(?=$)|(;)",
      "endCaptures": { "1": { "name": "punctuation.terminator.quirrel" } },
      "patterns": [
        { "include": "#let-binding-name" },
        { "include": "#type-annotation" },
        { "include": "#let-binding-name-next" },
        { "include": "#variable-assign" },
        { "include": "#variable-name-post" }
      ]
    },

    "let-binding-name": {
      "begin": "\\b(let)\\b",
      "beginCaptures": { "1": { "name": "storage.type.binding.quirrel" } },
      "end": "(?=$)|([_a-zA-Z][\\w]*)",
      "endCaptures": { "1": { "name": "variable.other.constant.quirrel" } },
      "patterns": [
        { "include": "#operator-optional" }
      ]
    },

    "let-binding-name-next": {
      "begin": ",",
      "beginCaptures": { "0": { "name": "punctuation.separator.comma.quirrel" } },
      "end": "([_a-zA-Z][\\w]*)",
      "endCaptures": { "1": { "name": "variable.other.constant.quirrel" } },
      "patterns": [
        { "include": "#global" }
      ]
    },

    "modifiers": {
      "patterns": [
        {
          "match": "\\b(enum|class)\\b",
          "name": "storage.type.class.quirrel"
        },
        {
          "match": "\\b(local|static|const|let)\\b",
          "name": "storage.modifier.quirrel"
        },
        {
          "match": "^\\s*(::)",
          "name": "storage.modifier.global"
        }
      ]
    },

    "for-loop": {
      "patterns": [
        {
          "begin": "\\b(for)\\b[\\s]*(\\()",
          "beginCaptures": {
            "1": { "name": "keyword.control.flow-control.quirrel" },
            "2": { "name": "meta.brace.round.quirrel" }
          },
          "end": "(\\))",
          "endCaptures": { "1": { "name": "meta.brace.round.quirrel" } },
          "patterns": [
            { "include": "#block" },
            { "include": "#block-contents" }
          ]
        },
        {
          "begin": "\\b(foreach)\\b[\\s]*(\\()",
          "beginCaptures": {
            "1": { "name": "keyword.control.flow-control.quirrel" },
            "2": { "name": "meta.brace.round.quirrel" }
          },
          "end": "(\\))",
          "endCaptures": { "1": { "name": "meta.brace.round.quirrel" } },
          "patterns": [
            {
              "match": "\\b(in)\\b",
              "name": "keyword.other.in.quirrel"
            },
            { "include": "#block" },
            { "include": "#block-contents" }
          ]
        }
      ]
    },

    "keywords": {
      "patterns": [
        {
          "begin": "(?<=if|while|for|foreach|)\\s*(\\()",
          "beginCaptures": { "2": { "name": "meta.brace.round.quirrel" } },
          "end": "\\)",
          "endCaptures": { "0": { "name": "meta.brace.round.quirrel" } },
          "patterns": [
            { "include": "#block-contents" }
          ]
        },
        {
          "begin": "(?<=catch)\\s*(\\()",
          "beginCaptures": { "2": { "name": "meta.brace.round.quirrel" } },
          "end": "\\)",
          "endCaptures": { "0": { "name": "meta.brace.round.quirrel" } },
          "patterns": [
            { "include": "#block-contents" }
          ]
        },
        {
          "match": "\\b(try|catch|throw)\\b",
          "name": "keyword.control.catch-exception.quirrel"
        },
        {
          "begin": "\\b(case|default)\\b",
          "beginCaptures": { "1": { "name": "keyword.control.flow-control.quirrel" } },
          "end": ":|$",
          "patterns": [
            { "include": "#global" },
            { "include": "#array" },
            { "include": "#constants" },
            { "include": "#strings" },
            {
              "match": "\\(",
              "name": "meta.brace.round.quirrel"
            },
            {
              "match": "\\)",
              "name": "meta.brace.round.quirrel"
            },
            { "include": "#operator-assignment" },
            { "include": "#punctuation-comma" },
            { "include": "#keywords" },
            { "include": "#method-call" },
            { "include": "#identifiers" }
          ]
        },
        {
          "match": "\\b(if|else|while|do|switch|case|break|for|foreach|return|yield|continue|resume|default)\\b",
          "name": "keyword.control.flow-control.quirrel"
        },
        {
          "match": "\\b(base|this)\\b",
          "name": "variable.language.quirrel"
        },
        {
          "match": "\\bconstructor\\b",
          "name": "keyword.operator.new.quirrel"
        },
        {
          "match": "\\b(delete|clone)\\b",
          "name": "keyword.operator.assignment.quirrel"
        },
        {
          "match": "\\b(in|not\\s+in|instanceof|typeof)\\b",
          "name": "keyword.operator.logical.quirrel"
        },
        {
          "match": "\\b(__LINE__|__FILE__)\\b",
          "name": "keyword.other.quirrel"
        },
        { "include": "#modifiers" }
      ]
    },

    "punctuation-braces": {
      "begin": "\\(",
      "beginCaptures": { "0": { "name": "meta.brace.round.quirrel" } },
      "end": "\\)",
      "endCaptures": { "0": { "name": "meta.brace.round.quirrel" } },
      "patterns": [
        { "include": "#keywords" },
        {
          "match": "\\bis\\b(?!\\()",
          "name": "keyword.other.quirrel"
        },
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "method-call": {
      "begin": "\\b([_A-Za-z][\\w]*)\\s*(\\()",
      "beginCaptures": {
        "1": { "name": "entity.name.function.quirrel" },
        "2": { "name": "meta.brace.round.quirrel" }
      },
      "end": "(\\))",
      "endCaptures": { "1": { "name": "meta.brace.round.quirrel" } },
      "patterns": [
        { "include": "#block" },
        { "include": "#block-contents" }
      ]
    },

    "operator-assignment": {
      "match": "(=)",
      "name": "keyword.operator.assignment.quirrel"
    },

    "operators": {
      "patterns": [
        {
          "match": "\\.\\.\\.",
          "name": "keyword.operator.variadic.quirrel"
        },
        {
          "begin": "\\$\\$\\{",
          "beginCaptures": { "0": { "name": "punctuation.definition.block.begin.quirrel" } },
          "end": "\\}",
          "endCaptures": { "0": { "name": "punctuation.definition.block.end.quirrel" } },
          "name": "meta.block.expression.quirrel",
          "patterns": [
            { "include": "#block" },
            { "include": "#block-contents" }
          ]
        },
        {
          "match": "(&&|\\|\\|)",
          "name": "keyword.operator.logical.quirrel"
        },
        {
          "match": "(~|&|\\||\\^|>>>|<<|>>)",
          "name": "keyword.operator.bitwise.quirrel"
        },
        {
          "match": "(==|!=|<=|>=|<=>|<|>)",
          "name": "keyword.operator.comparison.quirrel"
        },
        {
          "match": "(!)",
          "name": "keyword.operator.logical.quirrel"
        },
        {
          "match": "(\\-\\-|\\+\\+)",
          "name": "keyword.operator.increment-decrement.quirrel"
        },
        {
          "match": "(\\-|\\+|\\*|\\/|%)",
          "name": "keyword.operator.arithmetic.quirrel"
        },
        {
          "match": "(\\+=|\\-=|\\*=|/=|%=)",
          "name": "keyword.operator.assignment.quirrel"
        },
        {
          "match": "\\?\\?",
          "name": "keyword.operator.null-coalescing.quirrel"
        },
        {
          "begin": "\\?",
          "beginCaptures": { "0": { "name": "keyword.operator.ternary.quirrel" } },
          "end": ":",
          "endCaptures": { "0": { "name": "keyword.operator.ternary.quirrel" } },
          "patterns": [
            { "include": "#block-contents" }
          ]
        }
      ]
    },

    "punctuation-comma": {
      "match": ",",
      "name": "punctuation.separator.comma.quirrel"
    },

    "punctuation-accessor": {
      "match": "(\\?\\.\\$|\\?\\.|\\.\\$|\\.|<-|\\?\\[|\\?\\()",
      "name": "punctuation.accessor.quirrel"
    },

    "punctuation-terminator": {
      "match": ";",
      "name": "punctuation.terminator.quirrel"
    },

    "constant-name": {
      "match": "\\b([_A-Z][_A-Z0-9]*)\\b",
      "name": "variable.other.quirrel"
    },

    "identifier-name": {
      "match": "\\b([_A-Za-z][\\w]*)\\b",
      "name": "variable.other.quirrel"
    },

    "type-annotation": {
      "begin": "(:)\\s*",
      "beginCaptures": {
        "1": { "name": "punctuation.separator.type.quirrel" }
      },
      "end": "(?=[,)=;{$])",
      "patterns": [
        { "include": "#type-name" },
        {
          "match": "\\|",
          "name": "keyword.operator.type.union.quirrel"
        }
      ]
    },

    "type-name": {
      "patterns": [
        {
          "match": "\\b(bool|number|int|float|string|table|array|userdata|function|generator|userpointer|thread|instance|class|weakref|null|any)\\b(\\?)?",
          "captures": {
            "1": { "name": "support.type.primitive.quirrel" },
            "2": { "name": "keyword.operator.nullable.quirrel" }
          }
        },
        {
          "match": "\\b([A-Z][_A-Za-z0-9]*)\\b(\\?)?",
          "captures": {
            "1": { "name": "support.type.quirrel" },
            "2": { "name": "keyword.operator.nullable.quirrel" }
          }
        }
      ]
    }
  }
}
